<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Web GIS Bau-Bau
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <!-- CSS Files -->
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
  <link href="../assets/css/now-ui-dashboard.css?v=1.3.0" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="../assets/demo/demo.css" rel="stylesheet" />

    <!-- custom css -->
    <link href="../assets/css/custom.css" rel="stylesheet" />

    <!-- MapBox -->
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css' rel='stylesheet' />

    <style>
      #legend {
          display: block;
          margin: 0;
          padding: 0;
          padding: 10px;
          text-align: center;
      }

      #legend a {
          font-size: 13px;
          color: #404040;
          
          text-decoration: none;
          border-bottom: 1px solid rgba(0,0,0,0.25);
      }

      #legend a:last-child {
          border: none;
      }

      #legend a:hover {
          background-color: #f8f8f8;
          color: #404040;
      }

      #legend a.active {
          background-color: #3887be;
          color: #ffffff;
      }

      #legend a.active:hover {
          background: #3074a4;
      }
    </style>
</head>

<body class="">
  <div class="wrapper ">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg bg-yellow fixed-top" color-on-scroll="400">
    <div class="container">
      <div class="navbar-translate">
        <a class="navbar-brand logo-brand" href="index.html" rel="tooltip" title="Klik logo ini untuk kembali ke menu beranda" data-placement="bottom" target="_blank">
          <img src="../../../img/brand/logo-baubau.png" alt="logo-baubau">
          <span class="logo-title">Peta Bau-Bau</span>
        </a>
        <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-bar top-bar"></span>
          <span class="navbar-toggler-bar middle-bar"></span>
          <span class="navbar-toggler-bar bottom-bar"></span>
        </button>
      </div>
      <div class="collapse navbar-collapse justify-content-end" id="navigation" data-nav-image="./assets/img/blurred-image-1.jpg">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="index.html">Beranda <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#galeri" data-toggle="scroll">Galeri Foto</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#peraturan" data-toggle="scroll">Peraturan</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Base Map</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Profil Kumuh</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Tentang Website</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" rel="tooltip" title="Follow us on Twitter" data-placement="bottom" href="https://twitter.com/CreativeTim" target="_blank">
              <i class="fab fa-twitter"></i>
              <p class="d-lg-none d-xl-none">Twitter</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" rel="tooltip" title="Like us on Facebook" data-placement="bottom" href="https://www.facebook.com/CreativeTim" target="_blank">
              <i class="fab fa-facebook-square"></i>
              <p class="d-lg-none d-xl-none">Facebook</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" rel="tooltip" title="Follow us on Instagram" data-placement="bottom" href="https://www.instagram.com/CreativeTimOfficial" target="_blank">
              <i class="fab fa-instagram"></i>
              <p class="d-lg-none d-xl-none">Instagram</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- End Navbar -->

    <div class="panel-header panel-header-sm">
    </div>
    <div class="container">
      <div class="content">
        <div class="row">
          <div class="col-md-12">
            <div class="card ">
              <div class="card-header ">
                Base Map Kota Bau-Bau
              </div>
              <div class="card-body ">
                  <div id='map' class="map"></div>
                  <div class='map-overlay' id='legend'></div>
                
                <!-- <div class="container">
                  <div class="row">
                    <div class="col-sm-3">
                      <div class="btn-group-vertical center-botton" role="group" aria-label="Vertical button group">
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                      </div>
                    </div>
                    <div class="col-sm-3">
                      <div class="btn-group-vertical center-botton" role="group" aria-label="Vertical button group">
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                      </div>
                    </div>
                    <div class="col-sm-3">
                      <div class="btn-group-vertical center-botton" role="group" aria-label="Vertical button group">
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                      </div>
                    </div>
                    <div class="col-sm-3">
                      <div class="btn-group-vertical center-botton" role="group" aria-label="Vertical button group">
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                        <button type="button" class="btn btn-secondary">Button</button>
                      </div>
                    </div>
                  </div>                  
                </div> -->
                

              </div>
            </div>
          </div>
        </div>
      </div>
      <footer class="footer">
        <div class="container-fluid">
          <nav>
            <ul>
              <li>
                <a href="https://www.creative-tim.com">
                  Creative Tim
                </a>
              </li>
              <li>
                <a href="http://presentation.creative-tim.com">
                  About Us
                </a>
              </li>
              <li>
                <a href="http://blog.creative-tim.com">
                  Blog
                </a>
              </li>
            </ul>
          </nav>
          <div class="copyright" id="copyright">
            &copy;
            <script>
              document.getElementById('copyright').appendChild(document.createTextNode(new Date().getFullYear()))
            </script>, Designed by
            <a href="https://www.invisionapp.com" target="_blank">Invision</a>. Coded by
            <a href="https://www.creative-tim.com" target="_blank">Creative Tim</a>.
          </div>
        </div>
      </footer>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="../assets/js/core/jquery.min.js"></script>
  <script src="../assets/js/core/popper.min.js"></script>
  <script src="../assets/js/core/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  
  <!-- MapBox -->
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'></script>

  <!-- Chart JS -->
  <script src="../assets/js/plugins/chartjs.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="../assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../assets/js/now-ui-dashboard.min.js?v=1.3.0" type="text/javascript"></script>
  <!-- Now Ui Dashboard DEMO methods, don't include it in your project! -->
  <script src="../assets/demo/demo.js"></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiZmFraHJhd3kiLCJhIjoiY2pscWs4OTNrMmd5ZTNra21iZmRvdTFkOCJ9.15TZ2NtGk_AtUvLd27-8xA';
    
    var kendari = [122.599521, -5.468334];
    
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        center: kendari,
        zoom: 9
    });

    map.on('load', function() {
      // the rest of the code will go in here
      var geojson = {
        'batasLine' : 'line',
        'pantaiLine' : 'line',
        'kawasanBandara' : 'polygon'
      };
      var layers = ['0-10', '10-20', '20-50', '50-100', '100-200', '200-500', '500-1000', '1000+'];
      var colors = ['#FFEDA0', '#FED976', '#FEB24C'];
      
      var size = Object.keys(geojson).length;

      for (i = 0; i < size; i++) {
        legendMap(Object.keys(geojson)[i], Object.values(geojson)[i], colors[i]);
        // console.log(Object.keys(geojson)[i]);
      }

      map.getCanvas().style.cursor = 'default';
      // map.fitBounds([[-133.2421875, 16.972741], [-47.63671875, 52.696361]]);
    });

    function legendMap(names, types, colors){
  
        var name = names;
        var type = types;
        var color = colors;
        var item = document.createElement('div');
        var key = document.createElement('span');
        key.className = 'legend-key';
        key.style.backgroundColor = color;

        var terlihat = document.createAttribute('terlihat');
        terlihat.value = 'visible';
        visCssClass = '';

        var value = document.createElement('a');
        value.href = "#";
        value.className = visCssClass;

        if(type === 'polygon'){
            map.addLayer({
                'id': name,
                'type': 'fill',
                'name': name,
                'source': {
                    'type': 'geojson',
                    'data': 'http://localhost/pu-baubau/cobax/'+name+'.geojson',
                },
                'layout': {},
                'paint': {
                    'fill-color': color,
                    'fill-opacity': 0.8
                }
            });
        }else if(type === 'line'){
            map.addLayer({
                'id': name,
                'type': type,
                'name': name,
                'source': {
                    'type': 'geojson',
                    'data': 'http://localhost/pu-baubau/cobax/'+name+'.geojson',
                },
                "paint": {
                "line-color": color,
                "line-width": 2
                }
            });
        }

        map.setLayoutProperty(name, 'visibility', 'none');
        value.onclick = function (e) {
                
          e.preventDefault();
          e.stopPropagation();

          let visibility = $(this).attr("terlihat");
          console.log(visibility);
          if (visibility === 'visible') {
              map.setLayoutProperty(name, 'visibility', 'visible');
              this.className = 'active';
              terlihat.value = '';
          } else {
              this.className = '';
              map.setLayoutProperty(name, 'visibility', 'none');
              terlihat.value = 'visible';
          }
        };

        var nameLegend = document.createElement('span');
        nameLegend.innerHTML = name;

        value.setAttributeNode(terlihat);
        value.appendChild(key);
        value.appendChild(nameLegend);
        item.appendChild(value);
        legend.appendChild(item);

    }
  </script>
</body>

</html>